import Jimp from "jimp"; import { createWorker } from "tesseract.js"; export type OcrOptions = { lang?: string }; export async function ocrImageBuffer(input: Buffer, opts: OcrOptions = {}) { const lang = opts.lang || "spa"; const img = await Jimp.read(input); img.grayscale(); img.threshold({ max: 200 }); const processed = await img.getBufferAsync(Jimp.MIME_PNG); const worker = await createWorker(lang); try { const { data } = await worker.recognize(processed); return data.text; } finally { await worker.terminate(); } }
